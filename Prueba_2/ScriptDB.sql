--***BASE DE DATOS CREADA EN SQL SERVER***--
CREATE DATABASE TESTDEVBACKJR
GO
USE TESTDEVBACKJR

CREATE TABLE usuarios(
userId INT IDENTITY(1,1),
Login VARCHAR(100),
Nombre VARCHAR(100),
Paterno VARCHAR(100),
Materno VARCHAR(100)
PRIMARY KEY(userId)
)

CREATE TABLE empleados(
userId INT,
Sueldo FLOAT,
FechaIngreso DATE
CONSTRAINT FK_userId FOREIGN KEY (userId) REFERENCES usuarios(userId)
ON UPDATE CASCADE
ON DELETE CASCADE
)

--***INSERSICIÓN DE DATOS PROPORCIONADOS EN EL ARCHIVO DE EXCEL***--
--TABLA usuarios
INSERT INTO usuarios VALUES('user01','BERE','NARANJO','GONZALEZ')
INSERT INTO usuarios VALUES('user02','ALEXIS','CAMPOS','NARANJO')
INSERT INTO usuarios VALUES('user03','SERGIO ALEJANDRO','CAMPOS','HERNANDEZ')
INSERT INTO usuarios VALUES('user04','DIEGO ISMAEL','BERUMEN','CEDILLO')
INSERT INTO usuarios VALUES('user05','AURORA','ESCALANTE','PALAFOX')
INSERT INTO usuarios VALUES('user06','JOYCELENE FABIOLA','ESTRADA','BARBA')
INSERT INTO usuarios VALUES('user07','FRANCISCO','ESTRADA','GOMEZ')
INSERT INTO usuarios VALUES('user08','LEONARDO DANIEL','FARIAS','ROSAS')
INSERT INTO usuarios VALUES('user09','RAMON ANDRES','FIERROS','ROBLES')
INSERT INTO usuarios VALUES('user10','EDGAR ANDRES','FLORES','OLIVARES')
INSERT INTO usuarios VALUES('user11','MARIA FERNANDA','FRANCO','ESQUIVEL')
INSERT INTO usuarios VALUES('user12','ALEJANDRO','GALVAN','MUÑIZ')
INSERT INTO usuarios VALUES('user13','MARTHA ALICIA','GUTIERREZ','ORTIZ')
INSERT INTO usuarios VALUES('user14','JOSAFAT GERARDO','HERNANDEZ','SAUCEDO')
INSERT INTO usuarios VALUES('user15','ROSALIA','JIMENEZ','GONZALEZ')
INSERT INTO usuarios VALUES('user16','LAURA CELENE','JIMENEZ','RIOS')
INSERT INTO usuarios VALUES('user17','ANGELICA','LOPEZ','CORTES')
INSERT INTO usuarios VALUES('user18','CRISTIAN IVAN','LOPEZ','GOMEZ')
INSERT INTO usuarios VALUES('user19','MARLENE GABRIELA','LOPEZ','MEZA')
INSERT INTO usuarios VALUES('user20','ALEJANDRA','MEDINA','IBARRA')
INSERT INTO usuarios VALUES('user21','CONSUELO YURIDIANA THALIA','MEJIA','ALVAREZ')
INSERT INTO usuarios VALUES('user22','JAVIER ADRIAN','MEJIA','ALVAREZ')
INSERT INTO usuarios VALUES('user23','JUAN CARLOS EVARISTO','MEJIA','ALVAREZ')
INSERT INTO usuarios VALUES('user24','JAZMIN ALEJANDRA','PEREZ','VELEZ')
INSERT INTO usuarios VALUES('user25','GUSTAVO','RAMIREZ','RIVERA')
INSERT INTO usuarios VALUES('user26','CARLOS NIVARDO','RODRIGUEZ','ASCENCIO')
INSERT INTO usuarios VALUES('user27','KARLA JOHANA','ROMERO','LUEVANOS')
INSERT INTO usuarios VALUES('user28','YESSICA YOSELINNE','RUIZ','HERNANDEZ')
INSERT INTO usuarios VALUES('user29','CHRISTIAN EDUARDO','SALAS','SANCHEZ')
INSERT INTO usuarios VALUES('user30','LUIS ROBERTO','SALDAÑA','ESPINOZA')
INSERT INTO usuarios VALUES('user31','ADRIAN','SANCHEZ','ORTIZ')
INSERT INTO usuarios VALUES('user32','EDUARDO YAIR','SUAREZ','HERNANDEZ')
INSERT INTO usuarios VALUES('user33','JUAN FRANCISCO','TABAREZ','GARCIA')
INSERT INTO usuarios VALUES('user34','ZULEICA ELIZABETH','TERAN','TORRES')
INSERT INTO usuarios VALUES('user35','ADRIANA YUNUHEN','VARGAS','AYALA')
INSERT INTO usuarios VALUES('user36','OSCAR URIEL','VELAZQUEZ','ALVAREZ')
INSERT INTO usuarios VALUES('user37','ERICK DE JESUS','CORONA','DIAZ')
INSERT INTO usuarios VALUES('user38','MARIA GUADALUPE','RAMOS','HERNANDEZ')
INSERT INTO usuarios VALUES('user39','JESSICA NOEMI','JIMENEZ','VENTURA')
INSERT INTO usuarios VALUES('user40','FLOR MARGARITA','ROJAS','HERNANDEZ')
INSERT INTO usuarios VALUES('user41','LUIS ANTONIO','ALVARADO','VALENCIA')
INSERT INTO usuarios VALUES('user42','EDGAR IVAN','AGUILAR','PADILLA')
INSERT INTO usuarios VALUES('user43','LUIS ALFONSO','MICHEL','SANCHEZ')
INSERT INTO usuarios VALUES('user44','JOSE CARLOS','SILVA','ROCHA')
INSERT INTO usuarios VALUES('user45','JUDITH','RODRIGEZ','REYES')
INSERT INTO usuarios VALUES('user46','BRENDA SORAYA','CHAVEZ','GARCIA')
INSERT INTO usuarios VALUES('user47','ALMA ROSA','MARQUEZ','AGUILA')

--TABLA empleados
INSERT INTO empleados VALUES(1,8837,'2000-01-11')
INSERT INTO empleados VALUES(2,8837,'2000-01-11')
INSERT INTO empleados VALUES(3,15000,'2000-01-11')
INSERT INTO empleados VALUES(4,15000,'2000-01-11')
INSERT INTO empleados VALUES(5,7812,'2000-01-18')
INSERT INTO empleados VALUES(6,7812,'2000-01-18')
INSERT INTO empleados VALUES(7,10200,'2000-01-18')
INSERT INTO empleados VALUES(8,10200,'2000-01-18')
INSERT INTO empleados VALUES(9,13800,'2001-05-20')
INSERT INTO empleados VALUES(10,13800,'2001-05-20')
INSERT INTO empleados VALUES(11,18880,'2001-05-20')
INSERT INTO empleados VALUES(12,18880,'2001-05-20')
INSERT INTO empleados VALUES(13,8000,'2001-07-13')
INSERT INTO empleados VALUES(14,8000,'2001-07-13')
INSERT INTO empleados VALUES(15,6000,'2001-07-13')
INSERT INTO empleados VALUES(16,19470,'2001-07-13')
INSERT INTO empleados VALUES(17,19470,'2001-07-13')
INSERT INTO empleados VALUES(18,10200,'2001-07-16')
INSERT INTO empleados VALUES(19,10200,'2001-07-16')
INSERT INTO empleados VALUES(20,25000,'2001-07-16')
INSERT INTO empleados VALUES(21,7812,'2001-07-16')
INSERT INTO empleados VALUES(22,7812,'2001-07-16')
INSERT INTO empleados VALUES(23,12210,'2001-11-24')
INSERT INTO empleados VALUES(24,12210,'2001-11-24')
INSERT INTO empleados VALUES(25,7500,'2001-11-24')
INSERT INTO empleados VALUES(26,15020,'2001-11-24')
INSERT INTO empleados VALUES(27,15020,'2001-11-24')
INSERT INTO empleados VALUES(28,25000,'2001-11-24')
INSERT INTO empleados VALUES(29,7812,'2001-11-24')
INSERT INTO empleados VALUES(30,15020,'2001-12-12')
INSERT INTO empleados VALUES(31,15020,'2001-12-12')
INSERT INTO empleados VALUES(32,12210,'2001-12-12')
INSERT INTO empleados VALUES(33,12210,'2001-12-12')
INSERT INTO empleados VALUES(34,19470,'2008-08-17')
INSERT INTO empleados VALUES(35,19470,'2008-08-17')
INSERT INTO empleados VALUES(36,8000,'2008-08-17')
INSERT INTO empleados VALUES(37,8000,'2008-08-17')
INSERT INTO empleados VALUES(38,18880,'2009-06-11')
INSERT INTO empleados VALUES(39,18880,'2009-06-11')
INSERT INTO empleados VALUES(40,14000,'2009-06-11')
INSERT INTO empleados VALUES(41,13800,'2009-06-11')
INSERT INTO empleados VALUES(42,13800,'2009-06-11')
INSERT INTO empleados VALUES(43,15000,'2009-10-06')
INSERT INTO empleados VALUES(44,15000,'2009-10-06')
INSERT INTO empleados VALUES(45,13000,'2009-10-06')
INSERT INTO empleados VALUES(46,8837,'2009-10-06')


--***SENTENCIAS SQL***--

--Depurar solo los ID diferentes de 6,7,9 y 10 de la tabla usuarios 
SELECT * 
FROM usuarios 
WHERE userId NOT IN(6,7,9,10)

--Realiza una consulta para traer el nombre de usuario y fecha de ingreso de los usuarios que gananen mas de 10000 y 
--su apellido comience con T ordernado del mas reciente al mas antiguo
SELECT usuarios.Nombre + ' ' + usuarios.Paterno + ' ' + usuarios.Materno AS 'Nombre', empleados.FechaIngreso AS 'Fecha de Ingreso'
FROM usuarios INNER JOIN empleados
ON usuarios.userId = empleados.userId
WHERE empleados.Sueldo > 10000 AND (usuarios.Paterno LIKE 'T%' OR usuarios.Materno LIKE 'T%')
ORDER BY FechaIngreso DESC

--Realiza una consulta donde agrupes a los empleados por sueldo, un grupo con los que ganan menos de 1200 y 
--uno mayor o igual a 1200, cuantos hay en cada grupo?
SELECT
    CASE
        WHEN sueldo < 1200 THEN 'Menos de 1200'
        ELSE '1200 o más'
    END AS 'Sueldo',
    COUNT(userId) AS 'Num Empleados'
FROM empleados
GROUP BY 
    CASE
        WHEN sueldo < 1200 THEN 'Menos de 1200'
        ELSE '1200 o más'
    END
